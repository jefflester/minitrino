---
services:

  minitrino:
    environment:
      MINITRINO_BOOTSTRAP: bootstrap-env-var.sh
    volumes:
      - ./modules/catalog/test/resources/bootstrap/bootstrap-before-after.sh:/mnt/bootstrap/test/bootstrap-before-after.sh:ro

  test:
    build:
      context: ./modules/catalog/test/
      labels:
        - org.minitrino.root=true
    command: [tail, -f, /dev/null]
    image: minitrino/test:latest
    container_name: test-${CLUSTER_NAME}
    environment:
      MINITRINO_BOOTSTRAP: bootstrap-test.sh
    volumes:
      - test-data:/etc/test/
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.catalog.test=true

volumes:
  test-data:
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.catalog.test=true
