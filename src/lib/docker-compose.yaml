---
services:

  minitrino:
    build:
      context: ./image/
      args:
        UBUNTU_VER: ${UBUNTU_VER}
        CLUSTER_VER: ${CLUSTER_VER}
        CLUSTER_DIST: ${CLUSTER_DIST}
        SERVICE_USER: ${SERVICE_USER}
      labels:
        - org.minitrino.root=true
        - org.minitrino.module.minitrino=true
    image: minitrino/cluster:${CLUSTER_VER}-${CLUSTER_DIST}
    container_name: minitrino-${CLUSTER_NAME}
    restart: 'no'
    environment:
      CLUSTER_NAME: ${CLUSTER_NAME}
    ports:
      - ${__PORT_MINITRINO}:8080
    volumes:
      - ${LIC_PATH}:${LIC_MOUNT_PATH}
    networks:
      - default
      - cluster_shared
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.minitrino=true

networks:
  default:
    name: minitrino_${CLUSTER_NAME}
    driver: bridge
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.minitrino=true
  cluster_shared:
    external: true
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.minitrino=true
