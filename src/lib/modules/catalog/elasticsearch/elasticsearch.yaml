---
services:

  minitrino:
    environment:
      MINITRINO_BOOTSTRAP: bootstrap-elasticsearch.sh
    volumes:
      - ./modules/catalog/elasticsearch/resources/cluster/elasticsearch.properties:/mnt/etc/catalog/elasticsearch.properties:ro

  elasticsearch:
    image: elasticsearch:${ELASTICSEARCH_VER}
    container_name: elasticsearch-${CLUSTER_NAME}
    environment:
      discovery.type: single-node
      bootstrap.memory_lock: true
      network.host: 0.0.0.0
      network.bind_host: 0.0.0.0
      xpack.security.enabled: false
      ES_JAVA_OPTS: -Xms256m -Xmx256m
    ports:
      - :9200
      - :9300
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data
    labels:
      - org.minitrino=root
      - org.minitrino.module.elasticsearch=catalog-elasticsearch

volumes:
  elasticsearch-data:
    labels:
      - org.minitrino=root
      - org.minitrino.module.elasticsearch=catalog-elasticsearch
