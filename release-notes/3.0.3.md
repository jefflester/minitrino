# Minitrino Release Notes: 3.0.3

## Release Overview

Minitrino 3.0.3 is a patch release that fixes a critical bug preventing the CLI
from working when installed from PyPI without a pre-existing library, and adds
automated smoke testing to catch similar issues in future releases.

**Key improvements:**

- Fixed `lib-install` and `config` commands failing when no library is installed
- Added minimal initialization mode for commands that don't require a library
- Added cross-platform PyPI smoke test workflow (Ubuntu + macOS)

**Table of Contents:**

- [CLI Changes and Additions](#cli-changes-and-additions)
- [Other](#other)

## CLI Changes and Additions

### Bug Fix: Commands Failing Without Library Installed

Fixed a critical bug where `minitrino lib-install` and `minitrino config`
commands would fail with "This operation requires a library to be installed"
error when run on a fresh installation from PyPI.

**Root cause:** During context initialization, the `_compare_versions()` method
was called unconditionally, which accessed `lib_dir`, which raised an error if
no library was found. This created a chicken-and-egg problem where users
couldn't install the library because the command to install it required a
library to already exist.

**The fix:**

- Renamed `_compare_versions()` to `_try_compare_versions()` and wrapped it in
  try/except to gracefully handle missing libraries
- Added `minimal=True` parameter to `initialize()` that skips library-dependent
  operations (module loading, cluster setup, Docker client initialization)
- Updated `lib-install` and `config` commands to use minimal initialization

This bug only affected users installing from PyPI into an isolated environment.
Users running from the repository or with an existing library were not affected
because the fallback logic found `src/lib/` in the repo tree.

## Other

### CI/CD: Post-Release Smoke Test

Added a new GitHub Actions workflow (`.github/workflows/smoke-test.yaml`) that
automatically runs after each release to verify the PyPI package works correctly
in an isolated environment.

**Key features:**

- **Truly isolated testing**: Does NOT checkout the repository, simulating an
  end-user installation experience
- **Cross-platform coverage**: Runs on both Ubuntu 22.04 and macOS 13
- **Comprehensive command testing**:
  - `minitrino config --reset` (without library - validates the bug fix)
  - `minitrino lib-install` (without library - validates the bug fix)
  - `minitrino modules` (with library)
  - `minitrino provision` with 30-second timeout (validates Docker integration)

This workflow would have caught the bug fixed in this release immediately after
the 3.0.2 release, rather than discovering it from user reports.

Closes #144.
