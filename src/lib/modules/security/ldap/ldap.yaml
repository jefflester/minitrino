---
services:

  minitrino:
    environment:
      CONFIG_PROPERTIES: http-server.authentication.type=PASSWORD
    volumes:
      - ./modules/security/ldap/resources/ldap/ldif:/mnt/etc/ldif:ro
      - ./modules/security/ldap/resources/bootstrap/bootstrap-cluster.sh:/mnt/bootstrap/ldap/bootstrap-cluster.sh:ro
      - ./modules/security/ldap/resources/cluster/password-authenticator.properties:/mnt/etc/password-authenticator.properties:ro
    links:
      - ldap:ldap.minitrino.com

  ldap:
    image: osixia/openldap:${OPEN_LDAP_VER}
    container_name: ldap-${CLUSTER_NAME}
    hostname: ldap.minitrino.com
    environment:
      LDAP_ORGANISATION: Minitrino Inc.
      LDAP_DOMAIN: minitrino.com
      LDAP_ADMIN_PASSWORD: trinoRocks15
      LDAP_TLS_VERIFY_CLIENT: try
      LDAPTLS_REQCERT: never
    ports:
      - ${__PORT_LDAP}:636
    labels:
      - org.minitrino.root=true
      - org.minitrino.module.security.ldap=true
